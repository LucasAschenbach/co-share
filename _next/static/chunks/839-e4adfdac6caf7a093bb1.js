(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[839],{9956:function(e,t){"use strict";var n=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function r(e,t){switch(e.to){case"all":return t;case"all-except-one":return t.filter((function(t){return t!=e.except}));case"all-except-multiple":return t.filter((function(t){return!e.except.includes(t)}));case"all-fiter":return t.filter(e.filter);case"one":return[e.one]}}Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0,t.Action={create:function(e,t,o,i){void 0===i&&(i=!1);var c=Object.assign((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.apply(void 0,n([void 0],e,!1))}),{forwardFrom:function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];try{o.apply(void 0,n([t],r,!1))}catch(c){if(null==t)throw c;e.log.publishTo({to:"one",one:t},c)}},publishTo:function(o){for(var i=[],c=1;c<arguments.length;c++)i[c-1]=arguments[c];for(var a=r(o,e.links),u=0,l=a;u<l.length;u++){var s=l[u];s.publish.apply(s,n([t],i,!1))}},identifier:t});if(!i&&e.actionMap.has(t))throw'Action "'+t+'" already exists on store ('+e+"). If you want to overwrite the action, set the overwrite parameter to true.";return e.actionMap.set(t,c),c}}},6480:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3128:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=void 0,t.isBrowser=function(){return![typeof window,typeof document].includes("undefined")},o(n(6480),t),o(n(4948),t),o(n(7131),t),o(n(9956),t),o(n(970),t),o(n(6630),t)},8077:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(2111),t)},2111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useChildStore=void 0;var r=n(7378),o=n(6839),i=new Set;t.useChildStore=function(e,t,n,c,a){var u=(0,r.useMemo)((function(){return Array.from(i).find((function(t){return t.parentStore===e&&t.path===a}))}),[]);if(null==u)throw e.subscribeToChild(n,t,a).pipe((0,o.tap)((function(t){var n=t[0],r=t[1];return i.add({referenceCount:0,parentStore:e,path:a,hostLink:r,store:n})})),(0,o.retryWhen)((function(e){return e.pipe((0,o.delay)(c))}))).toPromise();return(0,r.useEffect)((function(){return u.referenceCount+=1,function(){u.referenceCount-=1,0===u.referenceCount&&(u.store.unsubscribe.publishTo({to:"one",one:u.hostLink}),u.hostLink.close(),i.delete(u))}}),[u]),u.store}},6630:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.takeOneOptional=t.Request=void 0;var o=n(4039),i=n(6839),c=n(9956);function a(e){return e?(0,i.take)(1):function(e){return e}}t.Request={create:function(e,t,n,u,l){void 0===u&&(u=!1),void 0===l&&(l=!1);var s=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];try{return n.apply(void 0,r([e],t,!1))}catch(c){return(0,o.throwError)(c)}},f=new o.Subject,h=new o.Subject,p=new o.Subject,d=new o.Subject,b="next_"+t,v="error_"+t,g="complete_"+t,y="request_"+t,m="cancel_"+t,w=c.Action.create(e,b,(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return f.next(t)}),l),x=c.Action.create(e,v,(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return p.next(t)}),l),S=c.Action.create(e,g,(function(e,t){return h.next(t)}),l),j=c.Action.create(e,y,(function(e,t){for(var n=[],c=2;c<arguments.length;c++)n[c-2]=arguments[c];null!=e&&s.apply(void 0,r([e],n,!1)).pipe(a(!u),(0,i.tap)((function(n){return w.publishTo({to:"one",one:e},t,n)}),(function(n){return x.publishTo({to:"one",one:e},t,n)}),(function(){u&&S.publishTo({to:"one",one:e},t)})),(0,i.catchError)((function(){return o.EMPTY})),(0,i.takeUntil)(d.pipe((0,i.filter)((function(e){return e===t}))))).subscribe()}),l),k=c.Action.create(e,m,(function(e,t){return d.next(t)}),l);return Object.assign((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.apply(void 0,r([void 0],e,!1))}),{forwardFrom:s,publishTo:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new o.Observable((function(n){var c=Math.round(Math.random()*Number.MAX_SAFE_INTEGER),l=(0,i.filter)((function(e){return e[0]===c})),s=!1,d=(0,o.merge)(f.pipe(l,a(!u),(0,i.tap)((function(e){e[0];var t=e[1];n.next(t),u||(s=!0,n.complete())}))),p.pipe(l,(0,i.tap)((function(e){e[0];var t=e[1];s=!0,n.error(t)}))),h.pipe((0,i.filter)((function(e){return e===c})),(0,i.tap)((function(){s=!0,n.complete()})))).subscribe();return j.publishTo.apply(j,r([{to:"one",one:e},c],t,!1)),function(){s||(d.unsubscribe(),k.publishTo({to:"one",one:e},c))}}))}})}},t.takeOneOptional=a},4948:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootStoreDefaultLinkId=void 0,t.RootStoreDefaultLinkId=Number.MIN_SAFE_INTEGER},7131:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Store=void 0;var o=n(4039),i=n(6839),c=n(9956),a=n(6630),u=function(){function e(){var e=this;this.linkSet=new Set,this.childStoreMap=new Map,this.actionMap=new Map,this.log=c.Action.create(this,"log",(function(e,t){return console.log(e,t)})),this.requestSubscribeToChild=a.Request.create(this,"requestSubscribeToChild",(function(t,n,r){if(null==t)throw'subscribeToChild can only be executed remotely using "publish"';var c=e.childStoreMap.get(r);return null==c?(0,o.throwError)('unable to find child in store at path entry "'+r+'"'):c instanceof c.subscriber.storeClass?new o.Observable((function(e){return c.subscriber(t.connection,(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(t)}),(function(t){return e.error(t)}))})).pipe((0,i.tap)((function(){return c.link(n,t.connection)}))):(0,o.throwError)("Subscribed store has no correct implemented subscriber. Subscriber must be created with the store class.")})),this.unsubscribe=c.Action.create(this,"unsubscribe",(function(t){if(null==t)throw"can't execute usubscribe locally";e.unlink(t)}))}return Object.defineProperty(e.prototype,"links",{get:function(){return Array.from(this.linkSet.values())},enumerable:!1,configurable:!0}),e.prototype.addChildStore=function(e,t,n){if(!t&&this.childStoreMap.has(n))throw'Store "'+n+'" already exists on store ('+e+"). If you want to overwrite the store, set the overwrite parameter to true.";e.parentStore=this,this.childStoreMap.set(n,e)},e.prototype.removeChildStore=function(e){var t=this.childStoreMap.get(e);null!=t&&(t.parentStore=this,this.childStoreMap.delete(e))},e.prototype.subscribeToChild=function(e,t,n){var o=this,c=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);return this.requestSubscribeToChild.publishTo(t,c,n).pipe((0,i.map)((function(a){var u=new(e.bind.apply(e,r([void 0],a,!1))),l=u.link(c,t.connection);return o.addChildStore(u,!1,n),l.onDisconnect.pipe((0,i.take)(1),(0,i.tap)((function(){return o.removeChildStore(n)}))).subscribe(),[u,l]})))},e.prototype.unlink=function(e){this.linkSet.delete(e),this.onUnlink(e)},e.prototype.link=function(e,t){var n=this,c=new o.Subject,a={onDisconnect:c,connection:t,close:function(){return c.next()},publish:function(n){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return t.publish.apply(t,r([e,n],o,!1))}};return this.linkSet.add(a),this.onLink(a),t.receive().pipe((0,i.filter)((function(t){var n=t[0];return e===n})),(0,i.tap)((function(e){var t=e[1],o=e.slice(2),i=n.actionMap.get(t);if(null!=i)try{i.forwardFrom.apply(i,r([a],o,!1))}catch(c){n.log.publishTo({to:"one",one:a},"error occured when executing "+t+": "+c)}else n.log.publishTo({to:"one",one:a},"unkown action "+t)})),(0,i.takeUntil)(c),(0,i.finalize)((function(){return n.unlink(a)}))).subscribe(),a},e.prototype.close=function(){this.links.forEach((function(e){return e.close()}))},e}();t.Store=u},970:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriber=void 0,t.Subscriber={create:function(e,t){return Object.assign(t,{storeClass:e})}}},9138:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(4246);function o(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex-grow-1"}),(0,r.jsx)("footer",{className:"bg-light",children:(0,r.jsxs)("div",{className:"d-flex align-items-center justify-content-around p-3 container-lg",children:[(0,r.jsxs)("a",{target:"_blank",href:"https://github.com/cocoss-org/co-share",className:"text-black d-flex flex-row align-items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-github mx-2",viewBox:"0 0 16 16",children:(0,r.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"})}),(0,r.jsx)("span",{className:"h5 mb-0",children:"Github"})]}),(0,r.jsx)("a",{target:"_blank",href:"https://www.coconut-xr.com/",children:(0,r.jsx)("img",{height:50,src:"/powered-by.svg"})})]})})]})}},1655:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(4246),o=[{title:"Counter",url:"/counter"},{title:"Request",url:"/request"},{title:"Message",url:"/message"},{title:"Group Chat",url:"/group-chat"},{title:"Lockable",url:"/lockable"},{title:"Optimistic Lockable",url:"/optimistic-lockable"},{title:"Whiteboard",url:"/whiteboard"},{title:"Transformable",url:"/transformable"}];function i(e){var t=e.selectedIndex;return(0,r.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:(0,r.jsxs)("div",{className:"container-fluid",children:[(0,r.jsx)("a",{className:"navbar-brand",href:"/",children:"co-share examples"}),(0,r.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNavDropdown","aria-controls":"navbarNavDropdown","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,r.jsx)("span",{className:"navbar-toggler-icon"})}),(0,r.jsx)("div",{className:"align-self-flex-end collapse navbar-collapse",id:"navbarNavDropdown",children:(0,r.jsx)("ul",{className:"navbar-nav",children:o.map((function(e,n){var o=e.title,i=e.url;return(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)("a",{className:"nav-link ".concat(n===t?"active":""),href:i,children:o})},o)}))})})]})})}},7982:function(e,t,n){"use strict";n.d(t,{X:function(){return m}});var r=n(4246),o=n(7378),i=n(3128),c=n(18),a=n(6610),u=n(5991),l=n(2952),s=n(4586),f=function(){function e(t,n){(0,a.Z)(this,e),this.rootStore=t,this.log=n}return(0,u.Z)(e,[{key:"createConnection",value:function(){var e=this,t=(0,s.Z)(),n=new l.xQ,r=new l.xQ;this.log&&(n.subscribe((function(e){var n;return(n=console).log.apply(n,["client ".concat(t," to server:")].concat((0,c.Z)(e)))})),r.subscribe((function(e){var n;return(n=console).log.apply(n,["server to client ".concat(t,":")].concat((0,c.Z)(e)))})));var o=function(){e.log&&console.log("client ".concat(t," is now disconnected from the server")),n.complete(),r.complete()},a={userData:{id:t},disconnect:o,publish:function(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];return n.next([e,t].concat(o))},receive:function(){return r}},u={userData:{id:t},disconnect:o,publish:function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return r.next([e,t].concat(o))},receive:function(){return n}};return new Promise((function(n,r){return e.rootStore.subscriber(u,(function(){e.log&&console.log("client ".concat(t," connected to server")),e.rootStore.link(i.RootStoreDefaultLinkId,u),n(a)}),r)}))}}]),e}(),h=n(3349),p=n(5255),d=n(6089),b=n(7608),v=n(6156);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,b.Z)(e);if(t){var o=(0,b.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,d.Z)(this,n)}}var y=function(e){(0,p.Z)(n,e);var t=g(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),(0,v.Z)((0,h.Z)(e),"subscriber",i.Subscriber.create(n,(function(e,t,n){return t()}))),e}return(0,u.Z)(n,[{key:"onUnlink",value:function(e){}},{key:"onLink",value:function(e){}}]),n}(i.Store);function m(e){var t=e.children,n=e.initStore,i=e.log,c=e.twoClients,a=(0,o.useState)(void 0),u=a[0],l=a[1];return(0,o.useEffect)((function(){var e=new y;n(e);var t=new f(e,null!==i&&void 0!==i&&i);Promise.all(new Array(c?2:1).fill(null).map((function(){return t.createConnection()}))).then(l)}),[i,l,n,c]),null==u?null:(0,r.jsx)(r.Fragment,{children:u.map((function(e,n){return(0,r.jsxs)("div",{className:"d-flex flex-column flex-grow-1 flex-basis-0 m-3 flex-shrink-1",children:[(0,r.jsxs)("h6",{children:["Client ",e.userData.id]}),(0,r.jsx)("div",{className:"flex-grow-1 flex-basis-0 border border-2 rounded-3",children:(0,r.jsx)(w,{connection:e,children:t})},e.userData.id)]},e.userData.id)}))})}function w(e){var t=e.children,n=e.connection,c=(0,o.useMemo)((function(){if(null!=n){var e=new y;return e.link(i.RootStoreDefaultLinkId,n),e}}),[n]);return null==c?(0,r.jsx)("span",{children:"Connecting to root store ..."}):(0,r.jsx)(o.Suspense,{fallback:"loading ...",children:t(c)})}}}]);